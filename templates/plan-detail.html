{% extends "base.html" %}
{% load bootstrap3 %}
{% load querystring from django_tables2 %}
{% load title from django_tables2 %}
{% load trans blocktrans from i18n %}
{% load humanize %}
{% load static %}

{% block extra-styles %}
  <link rel="stylesheet" type="text/css" href="{% static 'css/libs/jquery.dataTables.min.css' %}" />
  <link rel="stylesheet" type="text/css" href="{% static 'css/libs/colReorder.dataTables.min.css' %}" />
  <link rel="stylesheet" type="text/css" href="{% static 'css/libs/fixedColumns.dataTables.min.css' %}" />
  <link rel="stylesheet" type="text/css" href="{% static 'css/libs/buttons.dataTables.min.css' %}" />

  <style>
    button.dt-button, div.dt-button, a.dt-button {
      white-space: normal;
    }
    div.dt-button-collection.fixed.four-column {
      width: 700px;
      height: 80%;
      overflow: auto;
    }
  </style>
{% endblock %}

{% block content %}
<div id="content">
  <!-- Plan Details -->
  
  <div id="breadcrumbs">
    <ol class="breadcrumb">
      <li class="breadcrumb-item"><a href="/">Plans</a></li>
      <li class="breadcrumb-item active">{{plan.display_name }}</li>
    </ol>
  </div>

  <h3>Plan Details</h3>
  <table class="table table-hover table-bordered table-striped">
    <tr>
      <td>Census Plan Id</td><td>{{ plan.census_plan_id }}</td>
    </tr>
    <tr>
      <td>Name</td><td>{{ plan.display_name }}</td>
    </tr>
    <tr>
      <td>State</td><td>{{ plan.admin_gov.state }}</td>
    </tr>

  </table>

  <!-- Plan Annual Attributes -->
  <h3>Plan Attributes</h3>
  {% if table.page %}
    <div class="table-container">
  {% endif %}

  {% block table %}
    <div class="table-responsive">
      <table id="plan-attr-table" class="table table-hover table-bordered table-striped" width="100%" {% if table.attrs %} {{ table.attrs.as_html }}{% endif %}>
        {% block table.thead %}
        <thead>
        
{#          <tr>#}
{#            <th colspan="6">#}
{#              <form method="post" class="form-inline form-search pull-right">#}
{#                {% csrf_token %}#}
{#                  <div>#}
{#                    <input id="search_form_id" name="search" type="text" class="form-control col-md-3" placeholder="ID, Name, State"{% if search %} value="{{ search }}"{% endif %}>#}
{#                    <button type="submit" class="btn btn-small btn-dark"><i class="fa fa-search"></i> Search</button>#}
{#                  </div>#}
{#              </form>#}
{#            </th>#}
{#          </tr>#}

          <tr>
            {% for column in table.columns %}
                {% if column.orderable %}
                <th {{ column.attrs.th.as_html }}><a href="{% querystring table.prefixed_order_by_field=column.order_by_alias.next %}">{{ column.header|title }}</a></th>
                {% else %}
                <th {{ column.attrs.th.as_html }}>{{ column.header|title }}</th>
                {% endif %}
            {% endfor %}
          </tr>
        </thead>
        {% endblock table.thead %}

        {% block table.tbody %}
        <tbody class="plan-attributes">
          {% for row in table.page.object_list|default:table.rows %} {# support pagination #}
            {% block table.tbody.row %}
            <tr class="{% cycle "odd" "even" %}">
                {% for column, cell in row.items %}
                    <td {{ column.attrs.td.as_html }}>
                    {% if column.header == 'Year' %}
                      {{ cell }}
                    {% else %}
                      {{ cell | intcomma }}
                    {% endif %}
                    </td>
                {% endfor %}
            </tr>
            {% endblock table.tbody.row %}
          {% empty %}
            {% if table.empty_text %}
            {% block table.tbody.empty_text %}
            <tr><td colspan="{{ table.columns|length }}">{{ table.empty_text }}</td></tr>
            {% endblock table.tbody.empty_text %}
            {% endif %}
          {% endfor %}
        </tbody>
        {% endblock table.tbody %}

        {% block table.tfoot %}
        <tfoot></tfoot>
        {% endblock table.tfoot %}
      </table>
    </div>
  {% endblock table %}

  {% if table.page %}
      {% block pagination %}
          {% bootstrap_pagination table.page url=request.get_full_path %}
      {% endblock pagination %}
    </div>
  {% endif %}

</div>
{% endblock %}

{% block extra-scripts %}
  <script src="{% static 'js/libs/jquery.dataTables.min.js' %}"></script>
  <script src="{% static 'js/libs/dataTables.colReorder.min.js' %}"></script>
  <script src="{% static 'js/libs/dataTables.fixedColumns.min.js' %}"></script>
  <script src="{% static 'js/libs/dataTables.buttons.min.js' %}"></script>
  <script src="{% static 'js/libs/buttons.colVis.min.js' %}"></script>
  <script type="text/javascript">
    $(document).ready(function() {
      $('#plan-attr-table').DataTable( {
          colReorder: true,
          scrollX: true,
          paging: false,
          info: false,
          searching: false,
          fixedColumns: {
              leftColumns:1
          },
          dom: 'Bfrtip',
          buttons:[
              {
                extend: 'colvis',
                collectionLayout: 'fixed four-column',
{#                columnText: function (dt, idx, title) {#}
{#                    return (idx+1)+': '+ title;#}
{#                }#}
              }
          ]
      } );
    } );
  </script>
{% endblock %}
